<html>
<body>
    <!-- Your site -->
    <br />
    <div class="container">
        <div class="row">
        <div class="well staples-blue">
            <h1>WebStaples - The Web Port of MyStaples</h1>
        </div>
        </div>
        <div class="row">
            <div class="menu col-sm-4 well">
                <ul>
                    <li class="active withripple shadow-z-3" data-target="#class1"><div class="status-band btn-success"></div><span>Class 1</span></li>
                    <li class="withripple shadow-z-2" data-target="#class2"><div class="status-band"></div><span>Class 2</span></li>
                    <li class="withripple shadow-z-2" data-target="#class3"><div class="status-band"></div><span>Class 3</span></li>
                    <li class="withripple shadow-z-2" data-target="#class4"><div class="status-band"></div><span>Class 4</span></li>
                    <li class="withripple shadow-z-2" data-target="#class5"><div class="status-band"></div><span>Class 5</span></li>
                    <li class="withripple shadow-z-2" data-target="#class6"><div class="status-band"></div><span>Class 6</span></li>
                    <li class="withripple shadow-z-2" data-target="#class7"><div class="status-band"></div><span>Class 7</span></li>
                    <li class="withripple shadow-z-2" data-target="#class8"><div class="status-band"></div><span>Class 8</span></li>
                </ul>

            </div>
                <div class="pages col-sm-8">
                    <div class="well page active" id="class1">
                        <h1>Class 1</h1>
                        <textarea class="form-control floating-label notes" placeholder="Homework" rows="5"></textarea>
                    </div>
                    <div class="well page" id="class2">
                        <h1>Class 2</h1>
                        <textarea class="form-control floating-label notes" placeholder="Homework" rows="5"></textarea>
                    </div>
                    <div class="well page" id="class3" >
                        <h1>Class 3</h1>
                        <textarea class="form-control floating-label notes" placeholder="Homework" rows="5"></textarea>
                    </div>
                    <div class="well page" id="class4" >
                        <h1>Class 4</h1>
                        <textarea class="form-control floating-label notes" placeholder="Homework" rows="5"></textarea>
                    </div>
                    <div class="well page" id="class5" >
                        <h1>Class 5</h1>
                        <textarea class="form-control floating-label notes" placeholder="Homework" rows="5"></textarea>
                    </div>
                    <div class="well page" id="class6" >
                        <h1>Class 6</h1>
                        <textarea class="form-control floating-label notes" placeholder="Homework" rows="5"></textarea>
                    </div>
                    <div class="well page" id="class7" >
                        <h1>Class 6</h1>
                        <textarea class="form-control floating-label notes" placeholder="Homework" rows="5"></textarea>
                    </div>
                    <div class="well page" id="class8" >
                        <h1>Class 6</h1>
                        <textarea class="form-control floating-label notes" placeholder="Homework" rows="5"></textarea>
                    </div>
                </div>
        </div>
        <div class="row well timer-block staples-blue">
            <h1 id="timerHeader"></h1>
            <div >
                <span >
                    <span id="currentTime" >0:00</span>
                </span>
                <div class="progress progress-striped active" >
                    <div class="progress-bar progress-bar-material-blue" id="classProgress" ></div>
                </div>
            </div>
            <table >
                <tr>
                    <td id="startTime"  >0:00</td>
                    <td class="text-right" id="endTime"  >0:00</td>
                </tr>
            </table>
        </div>
    </div>
    <!-- Your site ends -->
    <script src="//code.jquery.com/jquery-1.10.2.min.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>

    <script src="js/ripples.min.js"></script>
    <script src="js/material.min.js"></script>
    <script>
        function t(h,m) {
            return (h*60+m)*60;
        }
        schedule = [
            {
                name: 'Spanish 1B',
                timeStart: t(7,30),
                timeEnd: t(8,15)
            },
            {
                name: 'Study Skills',
                timeStart: t(8,20),
                timeEnd: t(9,5)
            },
            {
                name: "Algebra 2A",
                timeStart: t(9,10),
                timeEnd: t(10,0)
            },
            {
                name: "US History A",
                timeStart: t(10,5),
                timeEnd: t(10,49)
            },
            {
                name: "Lunch 1 (lab)",
                timeStart: t(10,54),
                timeEnd: t(11,9)
            },
            {
                name: "Chemistry A (2&3)",
                timeStart: t(14,14),
                timeEnd: t(15,42)
            },
            {
                name: "Programming",
                timeStart: t(15,47),
                timeEnd: t(16,54)
            },
            {
                name: "Free",
                timeStart: t(16,59),
                timeEnd: t(17,45)
            },
            {
                name: "Contact coder if you see this",
                timeStart: t(0,0),
                timeEnd: t(0,0)
            },
        ];
        var percentComplete = 0;
        var currentClass = null;

        $(document).ready(function() {
            $.material.init();
            var i = 0;
            $('.page').each(function() {
                var cls = schedule[i];
                $(this).find('h1').first().text(cls.name);
                i++;
            });
            i = 0;
            $('.menu li span').each(function(){
                var cls = schedule[i];
                $(this).text(cls.name);
                i++;
            });
            var classHeaderTO = setTimeout(function() {
                        if(currentClass!=null) $("#timerHeader").text(currentClass.name)
                    },
                    40);
            var progressLoop = setInterval(function(){
                var now = new Date(),
                then = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 0, 0, 0);
                var secsSinceMidnight = (now.getTime() - then.getTime())/1000;

                for(var classId = 0; classId < schedule.length-1; classId++) {
                    if(schedule[classId].timeStart < secsSinceMidnight && secsSinceMidnight < schedule[classId].timeEnd) {
                        currentClass = schedule[classId];
                        break;
                    } else {
                        $('.menu li[data-target="#class'+(classId+1)+'"]').addClass('btn-material-grey');
                    }
                    if(schedule[classId].timeEnd < secsSinceMidnight && secsSinceMidnight < schedule[classId+1].timeStart) {
                        currentClass = {
                            name: "Passing Time",
                            timeStart: schedule[classId].timeEnd,
                            timeEnd: schedule[classId+1].timeStart
                        };
                        break;
                    }
                }
                if(currentClass != null) {
                    $(".menu li").each(function() {
                        if($(this).data('target') != '#class'+(classId+1) ||
                                currentClass.name == "Passing Time") { $(this).removeClass('staples-blue'); return; }

                        $(this).addClass('staples-blue');
                    });
                    percentComplete = Math.round((secsSinceMidnight - currentClass.timeStart)/(currentClass.timeEnd - currentClass.timeStart)*10000)/100;

                    var timeThroughCurrentClass = currentClass.timeEnd - secsSinceMidnight;
                    var totalMins = Math.floor(timeThroughCurrentClass/60);
                    var min = totalMins == 0 ? "00" : ((totalMins < 10) ? "0" + totalMins : totalMins);
                    var sec = Math.floor(timeThroughCurrentClass%60);
                    sec = sec == 0 ? "00" : ((sec < 10) ? "0" + sec : sec);

                    $("#currentTime").text("-" + min + ":" + sec)/*.css("margin-left", percentComplete + "%").css("margin-left", "-=1.5em");*/

                    var hours = Math.floor(currentClass.timeStart/60/60);
                    totalMins = Math.floor(currentClass.timeStart/60);
                    min = totalMins == 0 ? "00" : ((totalMins%60 < 10) ? "0" + totalMins%60 : totalMins%60);
                    $("#startTime").text((hours > 12 ? hours-12 : hours) + ":" + min + (hours >= 12 ? " PM" : " AM"));

                    hours = Math.floor(currentClass.timeEnd/60/60);
                    totalMins = Math.floor(currentClass.timeEnd/60);
                    min = totalMins == 0 ? "00" : ((totalMins%60 < 10) ? "0" + totalMins%60 : totalMins%60);
                    $("#endTime").text( (hours > 12 ? hours-12 : hours) + ":" + min + (hours >= 12 ? " PM" : " AM"));

                    if(percentComplete>99.95) {
                        clearTimeout(classHeaderTO);
                        classHeaderTO = setTimeout(function() {
                            $("#timerHeader").addClass("active").after(800,/*fadeOut(800,*/ function() {
                                $("#timerHeader").text(currentClass.name);
                                $(this).removeClass("active");
//                                setTimeout(function(){$(this).fadeIn(800);}.bind(this),100);
                            });
                        }, 700);
                    }
                }
            }, 20);
            /*setInterval(function(){$("#classProgress").css("width", percentComplete + "%")}, 200);*/
        });
        $(".menu li").click(function() {
            if($(this).is('.active')) return;
            $(".menu li").removeClass("active").removeClass("shadow-z-3").addClass("shadow-z-2").find('.status-band').removeClass('btn-success');
            $(this).addClass("active").addClass("shadow-z-3").removeClass("shadow-z-2").find('.status-band').addClass('btn-success');

            var target = $($(this).data('target'));

            var oldPage = $('.page.active');
            oldPage.removeClass('active');

            setTimeout(function() {
                /*oldPage.fadeOut();
                target.fadeIn();*/
                target.addClass('active');
            }, 400);
        });
    </script>
</body>
</html>